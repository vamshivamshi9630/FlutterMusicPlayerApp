# Firebase Setup Instructions for Music Player App

## Project Details
- **Firebase Project:** musicplayerapp-flutter
- **Console:** https://console.firebase.google.com/project/musicplayerapp-flutter/overview

## Step 1: Run FlutterFire Configure
This command will auto-generate firebase_options.dart with your project credentials:

```powershell
dart pub global activate flutterfire_cli
flutterfire configure --project=musicplayerapp-flutter
```

When prompted, select:
- ✅ Windows (for development)
- ✅ Android (if targeting Android)
- ✅ iOS (if targeting iOS)
- ✅ Web (if targeting Web)

## Step 2: Enable Google Sign-In in Firebase

1. Go to Firebase Console → Authentication
2. Click "Sign-in method" tab
3. Enable "Google" provider
4. Configure OAuth consent screen if needed

## Step 3: Set Up Google OAuth for Windows/Desktop

For **Windows development**, you need to enable Google Sign-In locally:

### Option A: Use Default Google Sign-In (Recommended for Development)
```dart
// The google_sign_in package handles this automatically
// Just make sure the build is running on the same machine
```

### Option B: Create OAuth Credentials (For Production)
1. Go to Firebase Console → Project Settings → Service Accounts
2. Download your service account key
3. Or create OAuth 2.0 credentials in Google Cloud Console

## Step 4: Get Dependencies
```powershell
flutter pub get
```

## Step 5: Run the App
```powershell
flutter run
```

## Testing the Flow

1. **Initial Load:** Should show LoginScreen
2. **Click "Sign in with Google":**
   - Opens Google sign-in dialog
   - After login, navigates to WelcomeScreen
3. **Profile Menu:**
   - Click the profile avatar in top-right
   - Shows user email and "Sign Out" option
4. **Add/Remove Favorites:**
   - When logged in, favorites auto-sync to Firebase
   - Check Firebase Console → Firestore to see the data

## Firestore Database Rules

Add these rules for security (go to Firestore → Rules):

```
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /users/{userId} {
      allow read, write: if request.auth.uid == userId;
    }
  }
}
```

## Troubleshooting

### If flutterfire configure fails:
```powershell
# Clear cache and try again
flutter clean
flutter pub get
flutterfire configure --project=musicplayerapp-flutter
```

### If Firebase initialization fails:
- Make sure you have internet connection
- Check that the project ID matches in the console
- Try running: `firebase login` first

### If Google Sign-In doesn't work on Windows:
- The first time may require browser authentication
- Subsequent runs should work without browser

## Files Modified
- ✅ pubspec.yaml - Added Firebase packages
- ✅ lib/main.dart - Firebase initialization
- ✅ lib/services/auth_service.dart - Google Sign-In logic
- ✅ lib/services/cloud_sync_service.dart - Cloud sync to Firestore
- ✅ lib/services/favorites_manager.dart - Cloud sync on favorite changes
- ✅ lib/screens/login_screen.dart - Login UI
- ⏳ lib/firebase_options.dart - Auto-generated by flutterfire configure

## Next Steps After Configuration
1. Test Google Sign-In on your device
2. Add a favorite song and check Firestore
3. Test on another device/account to verify cross-device sync
